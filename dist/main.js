(()=>{"use strict";const e={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const o=new Uint8Array(16);function n(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(o)}const r=[];for(let y=0;y<256;++y)r.push((y+256).toString(16).slice(1));console.log(function(t,o,i){if(e.randomUUID&&!o&&!t)return e.randomUUID();const s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,o){i=i||0;for(let e=0;e<16;++e)o[i+e]=s[e];return o}return function(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}(s)}());const i=document.getElementById("cellindex"),s=document.getElementById("transcription"),c=document.getElementById("start"),l=document.getElementById("downloadButton");var d="",a={},u=0,p=1;let g;function w(e,t){if("speechSynthesis"in window&&g){const o=new SpeechSynthesisUtterance(e);o.voice=g,o.onend=()=>{t&&t()},window.speechSynthesis.speak(o)}else console.log("Text-to-Speech is not supported in this browser.")}if(c.disabled=!1,l.disabled=!0,l.addEventListener("click",(function(){!function(e,t="file.csv"){const o=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}(d,"data.csv")})),"speechSynthesis"in window?window.speechSynthesis.onvoiceschanged=()=>{const e=window.speechSynthesis.getVoices();g=e.find((e=>"en-US"===e.lang||"en-GB"===e.lang))}:console.log("Text-to-Speech is not supported in this browser."),"SpeechRecognition"in window||"webkitSpeechRecognition"in window){const h=new(window.SpeechRecognition||window.webkitSpeechRecognition);var f=0,S=!1;function m(e){let t=["","A","B","C","D"],o=parseInt(e);return o>t.length-1&&(t=1),t[o]}function C(e){if(e.length>0){for(const[t,o]of Object.entries(a))if("empty"===o){a[t]=e;break}Object.values(a).includes("empty")||(h.stop(),S=!0,w(`New record created. ${Object.entries(a).map((([e,t])=>`${e}: ${t}`)).join(", ")}`,(()=>{S=!1,h.start(),f=1})),function(e){const t=e.join(",")+"\n";""!==d&&(d+=t,console.log("Updated CSV Content:"),console.log(d))}(Object.values(a)))}}function b(e){const t=document.querySelector("table");if(t&&t.tBodies[0]&&t.tBodies[0].rows[u].cells[p]){const o=t.tBodies[0].rows[u].cells[p];o&&(o.textContent=e)}else u=0,p=1}h.lang="en-US",h.continuous=!1,h.onstart=()=>{console.log("Speech recognition started. Speak now."),c.disabled=!0},h.onresult=e=>{const t=e.results[0][0].transcript;if(console.log(`Recognized: ${t}`),t.toLowerCase().includes("alexa")&&(console.log("alexa"),console.log("Alexa detected! Performing an action..."),f=1,h.stop(),S=!0,i.textContent="cell: "+String(m(p))+String(u+1),w("Input any value, say Okay to enter.",(()=>{S=!1,h.start()}))),c.disabled=!0,h.stop(),1==f){if(console.log(`Command: ${t}`),i.textContent="cell: "+String(m(p))+String(u+1),t.toLowerCase().includes("create"))return console.log("Create New Record..."),a=function(e){const t={};return e.forEach((e=>{t[e]="empty"})),t}(Object.keys(a)),f=2,h.stop(),S=!0,w("You selected create. Now fill in each key value.",(()=>{S=!1,h.start()})),void Object.entries(a).map((([e,t])=>`${e}: ${t}`)).join(", ");if(t.toLowerCase().includes("okay"))return p+=1,void(i.textContent="cell: "+String(m(p))+String(u+1));if(t.toLowerCase().includes("ok"))return p+=1,void(i.textContent="cell: "+String(m(p))+String(u+1));if(t.toLowerCase().includes("alexa"))return void(s.textContent="What word do you input?");if(t.toLowerCase().includes("next")&&t.toLowerCase().includes("role"))return u+=1,p=1,void(i.textContent="cell: "+String(m(p))+String(u+1));if(t.toLowerCase().includes("next")&&t.toLowerCase().includes("column"))return p=1,void(i.textContent="cell: "+String(m(p))+String(u+1));if(t.toLowerCase().includes("previous")&&t.toLowerCase().includes("role"))return u-=1,void(i.textContent="cell: "+String(m(p))+String(u+1));if(t.toLowerCase().includes("previous")&&t.toLowerCase().includes("column"))return p-=1,void(i.textContent="cell: "+String(m(p))+String(u+1));if(t.toLowerCase().includes("quit"))return f=0,h.stop(),S=!1,s.textContent="Say Alexa, to start",void(c.disabled=!1);b(`${t}`),s.textContent=`${t}`}2!=f||(console.log(`Fill each field: ${t}`),C(t),Object.entries(a).map((([e,t])=>`${e}: ${t}`)).join(", "))},h.onend=()=>{console.log("Speech recognition ended."),c.disabled=!0,!1===S&&h.start()},h.onerror=e=>{console.error("Speech recognition error:",e.error),c.disabled=!1},c.onclick=()=>{w("Welcome, say Alexa to start.",(()=>{})),h.start()}}else alert("Sorry, your browser does not support the Web Speech API.")})();