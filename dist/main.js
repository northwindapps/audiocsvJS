(()=>{"use strict";const e={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const o=new Uint8Array(16);function n(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(o)}const r=[];for(let C=0;C<256;++C)r.push((C+256).toString(16).slice(1));console.log(function(t,o,i){if(e.randomUUID&&!o&&!t)return e.randomUUID();const s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,o){i=i||0;for(let e=0;e<16;++e)o[i+e]=s[e];return o}return function(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}(s)}());const i=document.getElementById("cellindex"),s=document.getElementById("transcription"),c=document.getElementById("start"),a=document.getElementById("downloadButton");var l="",d={},u=0,p=1,g=["alpha","bravo","charlie","delta"],h="";let w;function f(e,t){if("speechSynthesis"in window&&w){const o=new SpeechSynthesisUtterance(e);o.voice=w,o.onend=()=>{t&&t()},window.speechSynthesis.speak(o)}else console.log("Text-to-Speech is not supported in this browser.")}if(c.disabled=!1,a.disabled=!0,a.addEventListener("click",(function(){!function(e,t="file.csv"){const o=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}(l,"data.csv")})),"speechSynthesis"in window?window.speechSynthesis.onvoiceschanged=()=>{const e=window.speechSynthesis.getVoices();w=e.find((e=>"en-US"===e.lang||"en-GB"===e.lang))}:console.log("Text-to-Speech is not supported in this browser."),"SpeechRecognition"in window||"webkitSpeechRecognition"in window){const m=new(window.SpeechRecognition||window.webkitSpeechRecognition);var S=0,y=!1;function v(e){let t=["","A","B","C","D"],o=parseInt(e);return o>t.length-1&&(t=1),0==o&&(t=1),t[o]}function b(e){if(e.length>0){for(const[t,o]of Object.entries(d))if("empty"===o){d[t]=e;break}Object.values(d).includes("empty")||(m.stop(),y=!0,f(`New record created. ${Object.entries(d).map((([e,t])=>`${e}: ${t}`)).join(", ")}`,(()=>{y=!1,m.start(),S=1})),function(e){const t=e.join(",")+"\n";""!==l&&(l+=t,console.log("Updated CSV Content:"),console.log(l))}(Object.values(d)))}}function x(e){const t=document.querySelector("table");if(t&&t.tBodies[0]&&t.tBodies[0].rows[u].cells[p]){const o=t.tBodies[0].rows[u].cells[p];o&&(o.textContent=e)}else u=0,p=1}function L(e){return e.toLowerCase().replace("one","1").replace("two","2").replace("three","3").replace("four","4").replace("five","5").replace("six","6").replace("seven","7").replace("eight","8").replace("nine","9").replace("zero","10")}m.lang="en-US",m.continuous=!1,m.onstart=()=>{console.log("Speech recognition started. Speak now."),c.disabled=!0},m.onresult=e=>{const t=e.results[0][0].transcript;if(console.log(`Recognized: ${t}`),t.toLowerCase().includes("alexa")&&(console.log("alexa"),console.log("Alexa detected! Performing an action..."),S=1,m.stop(),y=!0,i.textContent="cell: "+String(v(p))+String(u+1),f("Initiate Listening Mode. Say something,then say Okay to enter.",(()=>{y=!1,m.start()}))),c.disabled=!0,m.stop(),1==S){if(console.log(`Command: ${t}`),i.textContent="cell: "+String(v(p))+String(u+1),t.toLowerCase().startsWith("create"))return console.log("Create New Record..."),d=function(e){const t={};return e.forEach((e=>{t[e]="empty"})),t}(Object.keys(d)),S=2,m.stop(),y=!0,f("You selected create. Now fill in each key value.",(()=>{y=!1,m.start()})),void Object.entries(d).map((([e,t])=>`${e}: ${t}`)).join(", ");if(t.toLowerCase().startsWith("revert"))return void x(h);if(t.toLowerCase().startsWith("okay"))return(p+=1)>g.length-1&&(p=1),void(i.textContent="cell: "+String(v(p))+String(u+1));if(t.toLowerCase().startsWith("ok"))return(p+=1)>g.length-1&&(p=1),void(i.textContent="cell: "+String(v(p))+String(u+1));if(t.toLowerCase().startsWith("alexa"))return void(s.textContent="Initiate Listening Mode. Say something,then say Okay to enter.");if(t.toLowerCase().startsWith("next")&&t.toLowerCase().includes("role"))return u+=1,p=1,void(i.textContent="cell: "+String(v(p))+String(u+1));if(t.toLowerCase().startsWith("next")&&t.toLowerCase().includes("column"))return p=1,void(i.textContent="cell: "+String(v(p))+String(u+1));if(t.toLowerCase().startsWith("previous")&&t.toLowerCase().includes("role"))return u-=1,void(i.textContent="cell: "+String(v(p))+String(u+1));if(t.toLowerCase().startsWith("previous")&&t.toLowerCase().includes("column"))return p-=1,void(i.textContent="cell: "+String(v(p))+String(u+1));if(t.toLowerCase().startsWith("quit"))return S=0,m.stop(),y=!1,s.textContent="Say Alexa, to start",void(c.disabled=!1);for(let e=0;e<g.length;e++)if(t.toLowerCase().includes(g[e].toLowerCase())){p=e+1;var o=t.toLowerCase().replace(g[e].toLowerCase(),"").replace(/\s/g,"");o=L(o);let n=parseInt(o);return isNaN(n)||(console.log(n),u=n-1),void(i.textContent="cell: "+String(v(p))+String(u+1))}x(`${t}`),s.textContent=`${t}`,h=`${t}`}2!=S||(console.log(`Fill each field: ${t}`),b(t),Object.entries(d).map((([e,t])=>`${e}: ${t}`)).join(", "))},m.onend=()=>{console.log("Speech recognition ended."),c.disabled=!0,!1===y&&m.start()},m.onerror=e=>{console.error("Speech recognition error:",e.error),c.disabled=!1},c.onclick=()=>{f("Welcome, say Alexa to start.",(()=>{})),m.start()}}else alert("Sorry, your browser does not support the Web Speech API.")})();