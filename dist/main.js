(()=>{"use strict";const e={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const o=new Uint8Array(16);function n(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(o)}const r=[];for(let m=0;m<256;++m)r.push((m+256).toString(16).slice(1));console.log(function(t,o,i){if(e.randomUUID&&!o&&!t)return e.randomUUID();const s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,o){i=i||0;for(let e=0;e<16;++e)o[i+e]=s[e];return o}return function(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}(s)}());const i=document.getElementById("cellindex"),s=document.getElementById("transcription"),c=document.getElementById("start"),a=document.getElementById("downloadButton");var l={},d=0,u=1,p=["alpha","bravo","charlie","delta"],g="",h=Array.from({length:33},(()=>Array(p.length).fill("")));let w;function f(e,t){if("speechSynthesis"in window&&w){const o=new SpeechSynthesisUtterance(e);o.voice=w,o.onend=()=>{t&&t()},window.speechSynthesis.speak(o)}else console.log("Text-to-Speech is not supported in this browser.")}if(c.disabled=!1,a.disabled=!1,a.addEventListener("click",(function(){!function(e,t="file.csv"){const o=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}([p.join(","),...h.map((e=>e.join(",")))].join("\n"),"data.csv")})),"speechSynthesis"in window?window.speechSynthesis.onvoiceschanged=()=>{const e=window.speechSynthesis.getVoices();w=e.find((e=>"en-US"===e.lang||"en-GB"===e.lang))}:console.log("Text-to-Speech is not supported in this browser."),"SpeechRecognition"in window||"webkitSpeechRecognition"in window){const C=new(window.SpeechRecognition||window.webkitSpeechRecognition);var S=0,y=!1;function b(e){let t=["","A","B","C","D"],o=parseInt(e);return o>t.length-1&&(t=1),0==o&&(t=1),t[o]}function v(e){if(e.length>0){for(const[t,o]of Object.entries(l))if("empty"===o){l[t]=e;break}Object.values(l).includes("empty")||(C.stop(),y=!0,f(`New record created. ${Object.entries(l).map((([e,t])=>`${e}: ${t}`)).join(", ")}`,(()=>{y=!1,C.start(),S=1})),appendRow(Object.values(l)))}}function x(e){const t=document.querySelector("table");if(t&&t.tBodies[0]&&t.tBodies[0].rows[d].cells[u]){const o=t.tBodies[0].rows[d].cells[u];o&&(o.textContent=e)}else d=0,u=1}function L(e){return e.toLowerCase().replace("one","1").replace("two","2").replace("three","3").replace("four","4").replace("five","5").replace("six","6").replace("seven","7").replace("eight","8").replace("nine","9").replace("zero","10")}C.lang="en-US",C.continuous=!1,C.onstart=()=>{console.log("Speech recognition started. Speak now."),c.disabled=!0},C.onresult=e=>{const t=e.results[0][0].transcript;if(console.log(`Recognized: ${t}`),t.toLowerCase().includes("alexa")&&(console.log("alexa"),console.log("Alexa detected! Performing an action..."),S=1,C.stop(),y=!0,i.textContent="cell: "+String(b(u))+String(d+1),f("Initiate Listening Mode. Say something,then say Okay to enter.",(()=>{y=!1,C.start()}))),c.disabled=!0,C.stop(),1==S){if(console.log(`Command: ${t}`),i.textContent="cell: "+String(b(u))+String(d+1),t.toLowerCase().startsWith("create"))return console.log("Create New Record..."),l=function(e){const t={};return e.forEach((e=>{t[e]="empty"})),t}(Object.keys(l)),S=2,C.stop(),y=!0,f("You selected create. Now fill in each key value.",(()=>{y=!1,C.start()})),void Object.entries(l).map((([e,t])=>`${e}: ${t}`)).join(", ");if(t.toLowerCase().startsWith("revert"))return void x(g);if(t.toLowerCase().startsWith("okay"))return(u+=1)>p.length-1&&(u=1),void(i.textContent="cell: "+String(b(u))+String(d+1));if(t.toLowerCase().startsWith("ok"))return(u+=1)>p.length-1&&(u=1),void(i.textContent="cell: "+String(b(u))+String(d+1));if(t.toLowerCase().startsWith("alexa"))return void(s.textContent="Initiate Listening Mode. Say something,then say Okay to enter.");if(t.toLowerCase().startsWith("next")&&t.toLowerCase().includes("role"))return d+=1,u=1,void(i.textContent="cell: "+String(b(u))+String(d+1));if(t.toLowerCase().startsWith("next")&&t.toLowerCase().includes("column"))return u=1,void(i.textContent="cell: "+String(b(u))+String(d+1));if(t.toLowerCase().startsWith("previous")&&t.toLowerCase().includes("role"))return d-=1,void(i.textContent="cell: "+String(b(u))+String(d+1));if(t.toLowerCase().startsWith("previous")&&t.toLowerCase().includes("column"))return u-=1,void(i.textContent="cell: "+String(b(u))+String(d+1));if(t.toLowerCase().startsWith("quit"))return S=0,C.stop(),y=!1,s.textContent="Say Alexa, to start",void(c.disabled=!1);for(let e=0;e<p.length;e++)if(t.toLowerCase().includes(p[e].toLowerCase())){u=e+1;var o=t.toLowerCase().replace(p[e].toLowerCase(),"").replace(/\s/g,"");o=L(o);let n=parseInt(o);return isNaN(n)||(console.log(n),d=n-1),void(i.textContent="cell: "+String(b(u))+String(d+1))}x(`${t}`),console.log(u+","+d),h[d][u-1]=`${t}`,s.textContent=`${t}`,g=`${t}`}2!=S||(console.log(`Fill each field: ${t}`),v(t),Object.entries(l).map((([e,t])=>`${e}: ${t}`)).join(", "))},C.onend=()=>{console.log("Speech recognition ended."),c.disabled=!0,!1===y&&C.start(),console.log("tablet?:"+w),w||(y=!1,C.start())},C.onerror=e=>{console.error("Speech recognition error:",e.error),c.disabled=!1},c.onclick=()=>{f("Welcome, say Alexa to start.",(()=>{})),C.start()}}else alert("Sorry, your browser does not support the Web Speech API.")})();