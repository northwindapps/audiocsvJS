(()=>{"use strict";const e={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const o=new Uint8Array(16);function n(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(o)}const s=[];for(let h=0;h<256;++h)s.push((h+256).toString(16).slice(1));console.log(function(t,o,r){if(e.randomUUID&&!o&&!t)return e.randomUUID();const i=(t=t||{}).random||(t.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,o){r=r||0;for(let e=0;e<16;++e)o[r+e]=i[e];return o}return function(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}(i)}());const r=document.getElementById("cellindex"),i=document.getElementById("transcription"),c=document.getElementById("start"),d=document.getElementById("downloadButton");var l="",a={},u=0,p=1;let w;function g(e,t){if("speechSynthesis"in window&&w){const o=new SpeechSynthesisUtterance(e);o.voice=w,o.onend=()=>{t&&t()},window.speechSynthesis.speak(o)}else console.log("Text-to-Speech is not supported in this browser.")}if(c.disabled=!1,d.disabled=!0,d.addEventListener("click",(function(){!function(e,t="file.csv"){const o=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(o),s=document.createElement("a");s.href=n,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}(l,"data.csv")})),"speechSynthesis"in window?window.speechSynthesis.onvoiceschanged=()=>{const e=window.speechSynthesis.getVoices();w=e.find((e=>"en-US"===e.lang||"en-GB"===e.lang))}:console.log("Text-to-Speech is not supported in this browser."),"SpeechRecognition"in window||"webkitSpeechRecognition"in window){const m=new(window.SpeechRecognition||window.webkitSpeechRecognition);var f=0,y=!1;function S(e){if(e.length>0){for(const[t,o]of Object.entries(a))if("empty"===o){a[t]=e;break}Object.values(a).includes("empty")||(m.stop(),y=!0,g(`New record created. ${Object.entries(a).map((([e,t])=>`${e}: ${t}`)).join(", ")}`,(()=>{y=!1,m.start(),f=1})),function(e){const t=e.join(",")+"\n";""!==l&&(l+=t,console.log("Updated CSV Content:"),console.log(l))}(Object.values(a)))}}function b(e){const t=document.querySelector("table");if(t&&t.tBodies[0]&&t.tBodies[0].rows[u].cells[p]){const o=t.tBodies[0].rows[u].cells[p];o&&(o.textContent=e)}else u=0,p=1}m.lang="en-US",m.continuous=!1,m.onstart=()=>{console.log("Speech recognition started. Speak now."),c.disabled=!0},m.onresult=e=>{const t=e.results[0][0].transcript;if(console.log(`Recognized: ${t}`),t.toLowerCase().includes("alexa")&&(console.log("alexa"),console.log("Alexa detected! Performing an action..."),f=1,m.stop(),y=!0,r.textContent=String(p)+","+String(u+1),g("Input any value, say Okay to enter.",(()=>{y=!1,m.start()}))),c.disabled=!0,m.stop(),1==f){if(console.log(`Command: ${t}`),r.textContent=String(p)+","+String(u+1),t.toLowerCase().includes("create"))return console.log("Create New Record..."),a=function(e){const t={};return e.forEach((e=>{t[e]="empty"})),t}(Object.keys(a)),f=2,m.stop(),y=!0,g("You selected create. Now fill in each key value.",(()=>{y=!1,m.start()})),void Object.entries(a).map((([e,t])=>`${e}: ${t}`)).join(", ");if(t.toLowerCase().includes("okay"))return void(p+=1);if(t.toLowerCase().includes("ok"))return void(p+=1);if(t.toLowerCase().includes("alexa"))return void(i.textContent="What word do you input?");if(t.toLowerCase().includes("next")&&t.toLowerCase().includes("role"))return u+=1,void(p=1);if(t.toLowerCase().includes("quit"))return f=0,m.stop(),y=!1,i.textContent="Say Alexa, to start",void(c.disabled=!1);b(`${t}`),i.textContent=`${t}`}2!=f||(console.log(`Fill each field: ${t}`),S(t),Object.entries(a).map((([e,t])=>`${e}: ${t}`)).join(", "))},m.onend=()=>{console.log("Speech recognition ended."),c.disabled=!0,!1===y&&m.start()},m.onerror=e=>{console.error("Speech recognition error:",e.error),c.disabled=!1},c.onclick=()=>{g("Welcome, say Alexa to start.",(()=>{})),m.start()}}else alert("Sorry, your browser does not support the Web Speech API.")})();